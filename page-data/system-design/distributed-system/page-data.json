{"componentChunkName":"component---src-templates-blog-post-js","path":"/system-design/distributed-system/","result":{"data":{"site":{"siteMetadata":{"title":"All models are wrong","author":"Qing Wei"}},"markdownRemark":{"id":"e3ea6bde-f347-5a91-a462-6d5d05e3bebf","excerpt":"Define Distributed System (Informally) In this document,  refers to Stateful software systems where there exists at least 1 operation that…","html":"<h2>Define Distributed System (Informally)</h2>\n<p>In this document, <code class=\"language-text\">Distributed Systems</code> refers to <strong>Stateful</strong> software systems where there exists at least 1 operation that involves network call. In practice, distributed systems are normally concurrent.</p>\n<h2>Things to consider</h2>\n<h3>Consistency model</h3>\n<p>Consistency models attempt to answer the following question:</p>\n<p>Does our system preserve orders of operations? Under what constraints. Eg. If we write <code class=\"language-text\">A</code>, then <code class=\"language-text\">B</code> into a registry, are we guaranteed to observe the data in the same sequence?</p>\n<p>This is important because in a stateful system, order of operations affect the state. In general, <code class=\"language-text\">Operation A, Operation B</code> is not equal to <code class=\"language-text\">Operation B, Operation A</code>. It is useful for participants of the system to be able observe operations in correct order.</p>\n<p>There are many different consistency models, eg</p>\n<ul>\n<li>Linearizability</li>\n<li>Sequential consistency</li>\n<li>Read your writes</li>\n</ul>\n<p>and many more, <a href=\"https://jepsen.io/consistency\">aphyr</a> documented a lot of them</p>\n<p>Consistency model is likely one of the most complicated part of a distributed system, not only because the vast number of different models, but also because it tends to span across multiple operations, when talking about consistency model, we are talking about how multiple operations interact with a state, and what kind of guarantee are we giving to each of those operations.</p>\n<h3>Synchronous vs Asynchronous</h3>\n<p>Here I am referring to the <code class=\"language-text\">user interaction</code> with our system, if user have to wait for a result, then the interaction is synchronous, if user does not need to wait for result, then it is asynchronous.</p>\n<p>Normally, synchronous interaction implies stronger requirement in terms of latency, as we normally want to minimize wait time of our user.</p>\n<p>Note: Different operations in a system can have different interaction mode</p>\n<h3>Atomicity</h3>\n<p>Atomicity guarantee an operation either completed or never happen, there should be no <code class=\"language-text\">observable</code> intermediate state.</p>\n<p>In the context of distributed system, it is not uncommon to have partial failure, eg. if an operation requires 2 stateful network call to complete it’s job, what should we do if 1 call succeeded and the other failed?</p>\n<p>This problem is fairly difficult to solve, and solution likely depends on your problem domain, possible solution includes 2PC, Saga Pattern.</p>\n<h3>Dependency of system time</h3>\n<p>Be aware on dependency of system time, in theory distributed system should rely on system time for correctness, but it is ok to depend on system time for other purpose like live-ness or debugging. We just need to keep in mind that clock drift is real.</p>\n<h3>Availability</h3>\n<p>Availability refers to the ability of the system to continue it’s operation even when part of the system is down.</p>\n<h3>Throughput and Latency</h3>\n<h3>Idempotency</h3>\n<p>It is typically for client to retry, thus it is crucial for api to be idempotent.</p>\n<h2>Trade off</h2>\n<p>In general, the stronger the consistency model you need, the worse throughput, latency and availability you will get.</p>\n<p>If you need extra mechanism to enforce atomicity, it is likely to worsen throughput, latency and availability too.</p>\n<h2>Checklist</h2>\n<p>This is a list of questions to ask when building distributed system:</p>\n<ol>\n<li>What happen if your system have network partition between your servers?</li>\n<li>What happen if multiple operations interleave with each other? (Concurrency)</li>\n<li>What happen if a message is delivered multiple times?</li>\n</ol>","frontmatter":{"title":"Things to consider when building distributed system","date":"December 23, 2019"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/system-design/distributed-system/","previous":{"fields":{"slug":"/books-summary/business-dynamics/"},"frontmatter":{"title":"Summary of Business Dynamics"}},"next":{"fields":{"slug":"/stateful-app/"},"frontmatter":{"title":"Build Stateful with fs2, cats-effect"}}}}}